[SERVICE]
    Flush         5
    Log_Level     info
    Parsers_File  /etc/td-agent-bit/parsers.conf
    Log_File      /var/opt/microsoft/docker-cimprov/log/fluent-bit.log

[INPUT]
    Name tail
    Tag oms.container.log.*
    Path /var/log/containers/*.log
    DB /var/opt/microsoft/docker-cimprov/state/fblogs.db
    Parser docker
    Mem_Buf_Limit 30m
    Path_Key filepath

[FILTER]
    Name record_modifier
    Match oms.container.log.*
    Whitelist_key log
    Whitelist_key stream
    Whitelist_key time
    Whitelist_key filepath

[FILTER]
    Name modify
    Match oms.container.log.*
    Rename log LogEntry
    Rename stream LogEntrySource
    Rename time LogEntryTimeStamp
    Rename filepath Filepath
    Add_if_not_present SourceSystem Containers

[OUTPUT]
    Name            oms
    Match           oms.container.log.*