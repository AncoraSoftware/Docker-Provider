{
  "$schema": "http://schema.express.azure.com/schemas/2015-01-01-alpha/RolloutParameters.json",
  "contentVersion": "1.0.0.0",
  "wait": [
    {
      "name": "waitSdpBakeTime",
      "properties": {
        "duration": "PT1H"
      }
    }
  ],
  "shellExtensions": [
    {
      "name": "PushChartToACR",
      "type": "ShellExtensionType",
      "properties": {
        "maxexecutiontime": "PT1H"
      },
      "package": {
        "reference": {
          "path": "scripts.tar.gz"
        }
      },
      "launch": {
        "command": [
          "/bin/bash",
          "pushChartToAcr.sh"
        ],
        "environmentVariables": [
          {
            "name": "RELEASE_STAGE",
            "value": "__RELEASE_STAGE__"
          },
          {
            "name": "ACR_APP_ID",
            "reference": {
              "provider": "AzureKeyVault",
              "parameters": {
                "secretId": "https://cdpxacrcredskv.vault.azure.net/secrets/ContainerInsightsProdACRAADAppId/f92f2264af2a417ea4f521fc3999910a"
              }
            }
          },
          {
            "name": "ACR_APP_SECRET",
            "reference": {
              "provider": "AzureKeyVault",
              "parameters": {
                "secretId": "https://cdpxacrcredskv.vault.azure.net/secrets/ContainerInsightsProdACRAADAppSecret/e5d15982508d4ceda190a388d25308ef"
              }
            }
          },
          {
            "name": "ACR_NAME",
            "value": "__ACR_NAME__"
          },
          {
            "name": "CHART_VERSION",
            "value": "__CHART_VERSION__"
          }
        ]
      }
    }
  ]
}